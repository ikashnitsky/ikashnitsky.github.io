[
  {
    "objectID": "2017/hello-r-world/index.html",
    "href": "2017/hello-r-world/index.html",
    "title": "Hello R world post",
    "section": "",
    "text": "Welcome to my blog!\nMy name is Ilya, I am a demographer. Here I plan to post some research related stuff. As I am crazy about R, my post will touch upon this tool/environment – I will share some tricks and cool visualizations. Eventually, I hope to contribute to the amazing R-bloggers project. First, I am going to post older bits – to gain momentum.\n\nJust to start with, let me show you a small and handy self-written R function.\nQuite often, visualizing data in R, we compose color palettes manually. It is nice to have a function that shows the actual colors of a vector with color values. Here it is.\n\nglimpse_colors <- function(colors_string){\n        n <- length(colors_string)\n        hist(1:n, breaks = 0:n, col = colors_string)\n}\n\nThe function takes a vector of colors as input and produces a basic uniform histogram with one bar for each color, filled accordingly. Let’s try it out. First, we create some colors, and then visualize them.\n\nlibrary(RColorBrewer)\npal <- brewer.pal(n = 9, name = 'BrBG')\nglimpse_colors(pal)\n\n\n\n\nEnjoy!\nP.S. If something similar exists in one of the well known packages, please tell me."
  },
  {
    "objectID": "2017/hmd-all-sex-ratio/index.html",
    "href": "2017/hmd-all-sex-ratio/index.html",
    "title": "Sex ratios in all countries from Human Mortality Database",
    "section": "",
    "text": "Sex ratios reflect the two basic regularities of human demographics: 1) there are always more boys being born; 2) males experience higher mortality throughout their life-course. The sex ratio at birth does not vary dramatically1 and is more or less constant at the level of 105-106 boys per 100 girls. Hence, differences in the sex ratio profiles of countries mainly reflect gender gap in mortality. In this post I will compare sex ratios age profiles in all countries included in Human Mortality Database.1 There are cases of big deviations from this natural constant. The most well known one is the skewed sex ratio in China, where decades of One Child Policy together with strong traditional son preference resulted in selective abortions. Read more: Frejka et. al (2010); Wang (2011); Basten and Verropoulou (2013).\nR gives amazing opportunities to grab data fast and easy. Thanks to Tim Riffe’s HMDHFDplus package, one can now download HMD data with just a couple of lines of R code.\nThere is a handy function in HMDHFDplus package – getHMDcountries(). It lists the codes for all countries in HMD. So it becomes really easy to loop through the database and download data for all countries.\n\n# load required packages\nlibrary(tidyverse) # version 1.0.0\nlibrary(HMDHFDplus) # version 1.1.8\n\ncountry <- getHMDcountries()\n\nexposures <- list()\nfor (i in 1: length(country)) {\n        cnt <- country[i]\n        exposures[[cnt]] <- readHMDweb(cnt, \"Exposures_1x1\",\n                                       ik_user_hmd, ik_pass_hmd)\n        \n        # let's print the progress\n        paste(i,'out of',length(country)) \n}\n\nPlease note, the arguments ik_user_hmd and ik_pass_hmd are my login credidantials at the website of Human Mortality Database, which are stored locally at my computer. In order to access the data, one needs to create an account at http://www.mortality.org/ and provide his own credidantials to the readHMDweb() function.\nNext, I select 2012 for comparison – it is quite recent, and for most of the HMD countries there are data for 2012. The loop goes through each of the countries’ dataframe in exposures list, selects data for 2012 and calculates sex ratio at each age. I also remove data for several populations (like East and West Germany separately).\n\nsr_age <- list()\n\nfor (i in 1:length(exposures)) {\n        di <- exposures[[i]]\n        sr_agei <- di %>% select(Year,Age,Female,Male) %>% \n                filter(Year %in% 2012) %>%\n                select(-Year) %>%\n                transmute(country = names(exposures)[i],\n                          age = Age, sr_age = Male / Female * 100)\n        sr_age[[i]] <- sr_agei\n}\nsr_age <- bind_rows(sr_age)\n\n# remove optional populations\nsr_age <- sr_age %>% filter(!country %in% c(\"FRACNP\",\"DEUTE\",\"DEUTW\",\"GBRCENW\",\"GBR_NP\"))\n\nAfter age 90, sex ratios become quite jerky due to the relatively small numbers of survivors. I decided to aggregate data after the age 90.\n\n# summarize all ages older than 90 (too jerky)\nsr_age_90 <- sr_age %>% filter(age %in% 90:110) %>% \n        group_by(country) %>% summarise(sr_age = mean(sr_age, na.rm = T)) %>%\n        ungroup() %>% transmute(country, age=90, sr_age)\n\ndf_plot <- bind_rows(sr_age %>% filter(!age %in% 90:110), sr_age_90)\n\nFinally, I plot the resulting sex ratios.\n\n# get nice font\nlibrary(extrafont)\nmyfont <- \"Roboto Condensed\"\n\n# finaly - plot\ngg <- ggplot(df_plot, aes(age, sr_age, color = country, group = country))+\n        geom_hline(yintercept = 100, color = 'grey50', size = 1)+\n        geom_line(size = 1)+\n        scale_y_continuous(limits = c(0, 120), expand = c(0, 0), breaks = seq(0, 120, 20))+\n        scale_x_continuous(limits = c(0, 90), expand = c(0, 0), breaks = seq(0, 80, 20))+\n        xlab('Age')+\n        ylab('Sex ratio, males per 100 females')+\n        facet_wrap(~country, ncol=6)+\n        theme_minimal(base_family = myfont, base_size = 15)+\n        theme(legend.position='none',\n              panel.border = element_rect(size = .5, fill = NA))\n\ngg\n\n\nThere is quite a variety in the sex ratio profiles. If the initial prevalence of males equalizes in Japan, Sweden, or Norway at around 60, in Russia, Belarus, and Ukraine this happens at around 30 due to very high male mortality. In many countries there are pronounced bumps in the sex ratio at ages 20-30, that are likely to be caused by international migration. For example, Scotland, Northern Ireland, Portugal, and New Zealand are experiencing substantial outflow of young men.\nWhat happened in Taiwan?\nThis post is based on my earlier tweet and gist."
  },
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": ".",
    "section": "",
    "text": "CV"
  },
  {
    "objectID": "about.html#bio",
    "href": "about.html#bio",
    "title": ".",
    "section": "BIO",
    "text": "BIO\nI was born in Israel, grew up in Moscow, during my PhD years lived in The Hague, and now live in Odense. Married and have two daughters. I got a bachelors in geography from Moscow State University in 2012, masters in demography from the National Research University Higher School of Economics (Moscow) in 2014, and PhD from University of Groningen in 2020.\n\n\nFeel free to contact me via email\nilya.kashnitsky at gmail dot com\nIlya"
  },
  {
    "objectID": "cv.html",
    "href": "cv.html",
    "title": "Academic CV",
    "section": "",
    "text": "Download current CV"
  },
  {
    "objectID": "dd.html",
    "href": "dd.html",
    "title": ".",
    "section": "",
    "text": "Demographic Digest is a regular column at Demoscope Weekly which publishes (in Russian) brief summaries of fresh demographic papers from the best academic journals.\n\nДемографический Дайджест – регулярная рубрика журнала Демоскоп Weekly, в которой приводятся краткие обзоры демографических статей, публикуемых в ведущих зарубежных журналах.\n\n\n[PROJECT WEBSITE]\n\n\n\n[ARCHIVE]"
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "demographeR’s notes",
    "section": "",
    "text": "No matching items"
  },
  {
    "objectID": "index.html#section-1",
    "href": "index.html#section-1",
    "title": "demographeR’s notes",
    "section": "2021",
    "text": "2021\n\n\n\n\nNo matching items"
  },
  {
    "objectID": "index.html#section-2",
    "href": "index.html#section-2",
    "title": "demographeR’s notes",
    "section": "2020",
    "text": "2020\n\n\n\n\nNo matching items"
  },
  {
    "objectID": "index.html#section-3",
    "href": "index.html#section-3",
    "title": "demographeR’s notes",
    "section": "2019",
    "text": "2019\n\n\n\n\nNo matching items"
  },
  {
    "objectID": "index.html#section-4",
    "href": "index.html#section-4",
    "title": "demographeR’s notes",
    "section": "2018",
    "text": "2018\n\n\n\n\nNo matching items"
  },
  {
    "objectID": "index.html#section-5",
    "href": "index.html#section-5",
    "title": "demographeR’s notes",
    "section": "2017",
    "text": "2017\n\n\n    \n                  \n            February 5, 2017\n        \n        \n            Sex ratios in all countries from Human Mortality Database\n            \n                \n                    r\n                \n                \n                    hmd\n                \n                \n                    death rates\n                \n            \n            \n        \n        \n            \n        \n    \n    \n                  \n            January 29, 2017\n        \n        \n            Hello R world post\n            \n                \n                    r\n                \n            \n            \n        \n    \n\n\nNo matching items"
  }
]